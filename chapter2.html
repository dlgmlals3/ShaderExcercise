<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SKSL 셰이더 교육 자료</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="header">
        <h1> SKSL 셰이더 교육 자료</h1>
        <p> Chapter 2. 랜덤 함수 이미지 샘플링 </p>

        <nav class="chapter-nav">
            <a href="index.html" class="chapter-btn">Chapter 1. 주요 함수 및 기본 도형 그리기 </a>
            <a href="chapter2.html" class="chapter-btn active">Chapter 2. 랜덤 함수 및 이미지 샘플링 </a>
            <a href="chapter3.html" class="chapter-btn">Chapter 3. 이미지 활용 알고리즘 </a>
        </nav>
    </div>

    <div class="container">
        <div class="lesson">
            <div class="lesson-header">
                <div class="lesson-title"> 랜덤 함수 만들기</div>
                <div class="lesson-description">
                    <h3> 학습 목표</h3>
                    랜덤 함수 만들어보자.<br>

                    <h3>🔍 분석 방법</h3>                        
                    1) 정규화 파악 (0 ~ 1), (-0.5 ~ 0.5)<br>
                    2) 코드 분해해서 주석 처리<br>
                    3) 간단한 함수로 바꾸어 보기 (smoothstep → step)<br>
                    4) 경계를 파악하고 경계를 파악 후 그려보기<br>
                    5) 경계 값 기준으로 영역에 공통 값을 지정할 수 있는지 확인<br>
                </div>
            </div>

            <div class="key-concepts">
                <div class="concepts-header" onclick="toggleConcepts('concepts5')">
                    <h4> 랜덤 함수 </h4><br>                    
                    <span class="toggle-icon" id="icon-concepts5">▼</span>
                </div>
                <div class="concepts-content" id="concepts5">
                    <ul>                       
                        <li><strong> 0 - 1 정규화 </strong><br>
                            <div class="code-example">                     
<code>uv = fragCoord / iResolution;
uv.y = 1.0 - uv.y; // Skia 좌표계 y축 반전
float y = p.x;
if (uv.x > .5) y = 0.;
</code>
                            </div>
                        </li>                        
                    </ul>
                </div>
            </div>

            <div class="lesson-content">
                <div class="editor-section">
                    <div class="section-header">SKSL 코드</div>
                    <textarea class="code-editor" id="editor2">uniform float2 iResolution;
half4 main(float2 fragCoord) {
    return half4(1.0);
}</textarea>
                    <div class="controls">
                        <button class="btn" onclick="compileShader(2)">실행</button>
                    </div>
                </div>
                
                <div class="preview-section">
                    <div class="section-header">미리보기</div>
                    <div id="error2"></div>
                    <div class="preview-container">
                        <div class="loading" id="loading2">CanvasKit 로딩 중...</div>
                        <canvas class="preview-canvas" id="canvas2" width="300" height="300" style="display: none;"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function toggleConcepts(conceptsId) {
            const content = document.getElementById(conceptsId);
            const icon = document.getElementById(`icon-${conceptsId}`);
            
            if (content.classList.contains('collapsed')) {
                content.classList.remove('collapsed');
                content.style.maxHeight = content.scrollHeight + 'px';
                icon.textContent = '▲';
                icon.style.transform = 'rotate(180deg)';
            } else {
                content.classList.add('collapsed');
                content.style.maxHeight = '0';
                icon.textContent = '▼';
                icon.style.transform = 'rotate(0deg)';
            }
        }

        function toggleCode(codeId) {
            const content = document.getElementById(codeId);
            const toggle = document.getElementById(`toggle-${codeId}`);
            
            if (content.classList.contains('collapsed')) {
                content.classList.remove('collapsed');
                content.style.maxHeight = '400px';
                toggle.textContent = '접기';
            } else {
                content.classList.add('collapsed');
                content.style.maxHeight = '0';
                toggle.textContent = '펼치기';
            }
        }

        // 초기 상태 설정
        document.addEventListener('DOMContentLoaded', function() {
            // 모든 concepts는 처음에 펼쳐져 있음
            const conceptsContents = document.querySelectorAll('.concepts-content');
            conceptsContents.forEach(content => {
                content.style.maxHeight = content.scrollHeight + 'px';
            });
        });

        // Placeholder functions for shader compilation
        function compileShader(id) {
            console.log(`Compiling shader ${id}...`);
            // 실제 셰이더 컴파일 로직이 여기에 들어갑니다
        }
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/canvaskit-wasm/0.38.0/canvaskit.min.js"></script>
    <script src="shader-tutorial.js"></script>
</body>
</html>