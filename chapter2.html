<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SKSL ì…°ì´ë” êµìœ¡ ìë£Œ</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="header">
        <h1> SKSL ì…°ì´ë” êµìœ¡ ìë£Œ</h1>
        <p>ë‹¨ê³„ë³„ë¡œ ë°°ìš°ëŠ” ì…°ì´ë” í”„ë¡œê·¸ë˜ë°</p>

        <nav class="chapter-nav">
            <a href="index.html" class="chapter-btn">Chapter 1. ë³µìŠµ</a>
            <a href="chapter2.html" class="chapter-btn active">Chapter 2. ???? </a>
            <a href="chapter3.html" class="chapter-btn">Chapter 3. ???? </a>
        </nav>
    </div>

    <div class="container">
        <div class="lesson">
            <div class="lesson-header">
                <div class="lesson-title"> ê·¸ë˜í”„ ê·¸ë ¤ë³´ê¸°</div>
                <div class="lesson-description">
                    ì—¬ëŸ¬ê°€ì§€ ê·¸ë˜í”„ë¥¼ ê·¸ë ¤ ë´…ë‹ˆë‹¤. <br>      
                    float y ê°’ì— ì›í•˜ëŠ” ìˆ˜ì‹ì„ ë„£ì–´ ë³´ì„¸ìš” <br>
                    x ê°’ì€ p.xë¥¼ ì‚¬ìš© í•©ë‹ˆë‹¤. <br>
                    ì´í•´ë¥¼ ë•ê¸° ìœ„í•´ y ê°’ì€ ì¢Œí‘œê³„ë¥¼ ìœ„ë¡œ ê°ˆìˆ˜ë¡ ì»¤ì§€ë„ë¡ ë³€í™˜ <br>
                    <code> float2 p = uv * 2.0 - 1.0;</code><br>
                    ì •ê·œí™” : xy : -1 ~ 1<br>
                </div>
            </div>
            
            <div class="key-concepts">
                <div class="concepts-header" onclick="toggleConcepts('concepts1')">
                    <h4>ğŸ“ˆ ìì£¼ ì‚¬ìš©í•˜ëŠ” ê·¸ë˜í”„</h4>
                    <span class="toggle-icon" id="icon-concepts1">â–¼</span>
                </div>
                <div class="concepts-content" id="concepts1">
                    <ul>
                        <li><strong>1. ì§ì„ :</strong><br>
                            <div class="code-example">
                                <code>float y = p.x;</code>
                            </div>
                        </li>
                        
                        <li><strong>2. ì‚¬ì¸ ê³¡ì„ :</strong><br>
                            <div class="code-example">
                                <code>float y = sin(p.x);</code>
                            </div>
                        </li>
                        
                        <li><strong>3. Fract ê³¡ì„  (í†±ë‹ˆíŒŒ ëª¨ì–‘):</strong><br>
                            <div class="code-example">
                                <code>float y = fract(sin(p.x));</code>
                            </div>
                            <a href="https://thebookofshaders.com/glossary/?search=fract" target="_blank">ğŸ“š Fract ì‚¬ìš©ë²•</a><br>
                            <em>fract(-1.3) = -2.0 + 0.7<br>fract(1.3) = 1.0 + 0.3</em>
                        </li>
                        
                        <li><strong>4. Step (ê³„ë‹¨ ê·¸ë˜í”„):</strong><br>
                            <div class="code-content" id="step-code">
                                <div class="code-example">
                                    <code>float y = step(0.5, p.x);
// ë˜ëŠ” ë” ë³µì¡í•œ ì˜ˆì œ:
// p *= 2.;
// float y = step(0.8, p.x);
// y -= step(1.2, p.x);</code>
                                </div>
                            </div>
                        </li>
                        
                        <li><strong>4.1. SmoothStep:</strong><br>
                            <div class="code-example">
                                <code>float y = smoothstep(0.0, 1.0, p.x);</code>
                            </div>
                        </li>
                        
                        <li><strong>5. ê°€ìš°ì‹œì•ˆ ê³¡ì„ :</strong><br>
                            <div class="code-example">
                                <code>float y = exp(-p.x * p.x);</code>
                            </div>
                        </li>
                        
                        <li><strong>6. ì ˆëŒ€ê°’ ê³¡ì„  (ëŒ€ì¹­):</strong><br>
                            <div class="code-example">
                                <code>float y = abs(p.x);</code>
                            </div>
                        </li>
                        
                        <li><strong>7. ì œê³± ê³¡ì„ :</strong><br>
                            <div class="code-example">
                                <code>float y = p.x * p.x;</code>
                            </div>
                        </li>
                        
                        <li><strong>8. ì œê³±ê·¼:</strong><br>
                            <div class="code-example">
                                <code>float y = sqrt(p.x);</code>
                            </div>
                        </li>
                        
                        <li><strong>9. ì½”ì‚¬ì¸:</strong><br>
                            <div class="code-example">
                                <code>float y = cos(p.x);</code>
                            </div>
                        </li>
                        
                        <li><strong>10. íƒ„ì  íŠ¸:</strong><br>
                            <div class="code-example">
                                <code>float y = tan(p.x);</code>
                            </div>
                        </li>
                        
                        <li><strong>11. Triangular Wave (ì§€ê·¸ì¬ê·¸):</strong><br>
                            <div class="code-example">
                                <code>float y = abs(fract(p.x) * 2.0 - 1.0);</code>
                            </div>
                        </li>
                        
                        <li><strong>ğŸ’¡ TIP - ì¢Œí‘œê³„ í™•ëŒ€ ë°©ë²•:</strong><br>
                            <div class="code-example">
                                <code>p *= 3.14;</code>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="lesson-content">
                <div class="editor-section">
                    <div class="section-header">SKSL ì½”ë“œ</div>
                    <textarea class="code-editor" id="editor1">
float y = p.x;           
                    </textarea>
                    <div class="controls">
                        <button class="btn" onclick="compileShader(1)">ğŸš€ ì‹¤í–‰</button>                     
                    </div>
                </div>
                
                <div class="preview-section">
                    <div class="section-header">ë¯¸ë¦¬ë³´ê¸°</div>
                    <div id="error1"></div>
                    <div class="preview-container">
                        <div class="loading" id="loading1">CanvasKit ë¡œë”© ì¤‘...</div>
                        <canvas class="preview-canvas" id="canvas1" width="300" height="300" style="display: none;"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <div class="lesson">
            <div class="lesson-header">
                <div class="lesson-title">ğŸ¨ íŒ¨í„´ ë§Œë“¤ê¸°</div>
                <div class="lesson-description">
                    <h3>ğŸ¯ í•™ìŠµëª©í‘œ</h3>
                    dot, step, smoothstep, fract, mod í•¨ìˆ˜ ì‚¬ìš©í•´ë³´ê¸°<br>
                    ë¶„ì„ë°©ë²•ì„ ë”°ë¼í•´ë³¸ë‹¤.<br>
                    <h3>âš¡ ì™ ë§Œí•˜ë©´ ë¶„ì„í•˜ì§€ë§ê³  í•¨ìˆ˜ ê°€ì ¸ë‹¤ ì“°ì.</h3><br><br>

                    <h3>ğŸ” ë¶„ì„ ë°©ë²•</h3>                        
                    1) ì •ê·œí™” íŒŒì•… (0 ~ 1), (-0.5 ~ 0.5)<br>
                    2) ì½”ë“œ ë¶„í•´í•´ì„œ ì£¼ì„ ì²˜ë¦¬<br>
                    3) ê°„ë‹¨í•œ í•¨ìˆ˜ë¡œ ë°”ê¾¸ì–´ ë³´ê¸° (smoothstep â†’ step)<br>
                    4) ê²½ê³„ë¥¼ íŒŒì•…í•˜ê³  ê²½ê³„ë¥¼ íŒŒì•… í›„ ê·¸ë ¤ë³´ê¸°<br>
                    5) ê²½ê³„ ê°’ ê¸°ì¤€ìœ¼ë¡œ ì˜ì—­ì— ê³µí†µ ê°’ì„ ì§€ì •í•  ìˆ˜ ìˆëŠ”ì§€ í™•ì¸<br>
                </div>
            </div>
            
            <div class="key-concepts">
                <div class="concepts-header" onclick="toggleConcepts('concepts2')">
                    <h4>ì› ë§Œë“¤ê¸°</h4>
                    <span class="toggle-icon" id="icon-concepts2">â–¼</span>
                </div>
                <div class="concepts-content" id="concepts2">
                    <ul>
                        <li><strong>ì •ê·œí™”</strong><br>
                            <div class="code-example">
                                <code>float2 uv = fragCoord / iResolution.xy;</code>
                            </div>
                        </li>
                        
                        <li><strong>ì›ì„ ë§Œë“œëŠ” ì½”ë“œ 1</strong>                            
                                <div class="code-example">
                                    <code>uniform float2 iResolution;
float circle(in vec2 _st, in float _radius) { 
    vec2 l = _st - vec2(0.5);
    return 1. - step(_radius, dot(l, l) * 2.0);
}
half4 main(float2 fragCoord) {
    float2 uv = fragCoord / iResolution.xy;    
    float color = circle(uv, 0.3);
    return half4(color, color, color, 1.0);
}</code>
                            </div>
                        </li>

                        <li><strong>ì›ì„ ë§Œë“œëŠ” ì½”ë“œ 2</strong>                            
                            <div class="code-example">
                                <code>uniform float2 iResolution;
float circle(in vec2 _st, in float _radius) {     
    float edge0 = _radius - (_radius * 0.01);
    float edge1 = _radius + (_radius * 0.01);
    return 1. - smoothstep(edge0, edge1, sqrt(dot(_st, _st)));
}
half4 main(float2 fragCoord) {
    float2 uv = fragCoord / iResolution.xy;
    float color = circle(uv, 0.3);
    return half4(color, color, color, 1.0);
}</code>
                            </div>
                        </li>

                        <li><strong>ì›ì„ ë§Œë“œëŠ” ì½”ë“œ 3</strong>                                                        
                            <div class="code-example">
                                <code>uniform float2 iResolution;
float circle(in vec2 _st, in float _radius) {     
    return 1. - smoothstep(_radius - (_radius * 0.01), 
                          _radius + (_radius * 0.01), 
                          dot(_st, _st) * 2.0);
}
half4 main(float2 fragCoord) {
    float2 uv = (fragCoord / iResolution.xy) - .5;    
    float color = circle(uv, 0.3);
    return half4(color, color, color, 1.0);
}</code>                             
                            </div>
                        </li>        
                    </ul>
                </div>
            </div>

            <div class="key-concepts">
                <div class="concepts-header" onclick="toggleConcepts('concepts3')">
                    <h4> ë°•ìŠ¤ ë§Œë“¤ê¸° </h4>
                    <span class="toggle-icon" id="icon-concepts3">â–¼</span>
                </div>
                <div class="concepts-content collapsed" id="concepts3">
                    <ul>
                        <li><strong>íŒ¨í„´ ë§Œë“¤ê¸° 1</strong>
                            <div class="code-example">
                                <code>uniform float2 iResolution;
half4 main(float2 fragCoord) {
    float2 uv = (fragCoord / iResolution.xy);    
    uv *= 3.0;
    uv = fract(uv);
    float3 color = float3(uv, 0.0);
    return half4(color, 1.0);
}</code>                            
                            </div>
                        </li>
                        <li><strong>ë°•ìŠ¤ íŒ¨í„´ ë§Œë“¤ê¸°</strong>                            
                            <div class="code-example">
                                <code>
vec2 tile(vec2 _st, float _zoom) {
    _st *= _zoom;
    return fract(_st);
}

float box(vec2 _st, vec2 _size, float _smoothEdges){
    _size = vec2(0.5) - _size * 0.5;
    vec2 aa = vec2(_smoothEdges * 0.5);
    vec2 uv = smoothstep(_size, _size + aa, _st);
    uv *= smoothstep(_size, _size + aa, vec2(1.0) - _st);
    return uv.x * uv.y;
}     

uniform float2 iResolution;    
half4 main(float2 fragCoord) {
    vec2 st = fragCoord.xy / iResolution.xy;
    vec3 color = vec3(0.0);
    st = tile(st, 4.);
    color = vec3(box(st, vec2(0.7), 0.01));
    return vec4(color,1.0);
}</code>                                 
                            </div>
                        </li>

                        <li><strong>ğŸ’¡ ë²¡í„° ì—°ì‚° íŒ</strong>
                            <div class="code-example">
                                <code>vec2(a, b) * vec2(c, d) = vec2(a * c, b * d);
dot(vec2(a, b), vec2(c, d)) = a * c + b * d;</code>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="key-concepts">
                <div class="concepts-header" onclick="toggleConcepts('concepts4')">
                    <h4> í„°í‹€ íŒ¨í„´ ë§Œë“¤ê¸° </h4>
                    <span class="toggle-icon" id="icon-concepts4">â–¼</span>
                </div>
                <div class="concepts-content collapsed" id="concepts4">
                    <ul>
                        <li><strong>í„°í‹€ íŒ¨í„´ ë§Œë“¤ê¸°</strong>                            
                            <div class="code-example">
                                <code>
uniform vec2 u_resolution;
uniform float u_time;

vec2 rotate2D (vec2 _st, float _angle) {
    _st -= 0.5;
    _st =  mat2(cos(_angle),-sin(_angle),
                sin(_angle),cos(_angle)) * _st;
    _st += 0.5;
    return _st;
}

vec2 tile (vec2 _st, float _zoom) {
    _st *= _zoom;
    return fract(_st);
}

vec2 rotateTilePattern(vec2 _st){
    //  Scale the coordinate system by 2x2
    _st *= 2.0;
    //  Give each cell an index number
    //  according to its position
    float index = 0.0;
    index += step(1., mod(_st.x,2.0));
    index += step(1., mod(_st.y,2.0))*2.0;

    //      |
    //  2   |   3
    //      |
    //--------------
    //      |
    //  0   |   1
    //      |
    // Make each cell between 0.0 - 1.0
    _st = fract(_st);
    // Rotate each cell according to the index
    if(index == 1.0){
        //  Rotate cell 1 by 90 degrees
        _st = rotate2D(_st,PI*0.5);
    } else if(index == 2.0){
        //  Rotate cell 2 by -90 degrees
        _st = rotate2D(_st,PI*-0.5);
    } else if(index == 3.0){
        //  Rotate cell 3 by 180 degrees
        _st = rotate2D(_st,PI);
    }
    return _st;
}

uniform float2 iResolution;    
void main (void) {
    vec2 st = gl_FragCoord.xy/iResolution.xy;

    st = tile(st,3.0);
    st = rotateTilePattern(st);

    // Make more interesting combinations
    // st = tile(st,2.0);
    // st = rotate2D(st,-PI*u_time*0.25);
    // st = rotateTilePattern(st*2.);
    // st = rotate2D(st,PI*u_time*0.25);

    // step(st.x,st.y) just makes a b&w triangles
    // but you can use whatever design you want.
    gl_FragColor = vec4(vec3(step(st.x,st.y)),1.0);
}
                                </code>                                 
                            </div>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="lesson-content">
                <div class="editor-section">
                    <div class="section-header">SKSL ì½”ë“œ</div>
                    <textarea class="code-editor" id="editor2">uniform float2 iResolution;
half4 main(float2 fragCoord) {
    return half4(1.0);
}</textarea>
                    <div class="controls">
                        <button class="btn" onclick="compileShader(2)">ì‹¤í–‰</button>
                    </div>
                </div>
                
                <div class="preview-section">
                    <div class="section-header">ë¯¸ë¦¬ë³´ê¸°</div>
                    <div id="error2"></div>
                    <div class="preview-container">
                        <div class="loading" id="loading2">CanvasKit ë¡œë”© ì¤‘...</div>
                        <canvas class="preview-canvas" id="canvas2" width="300" height="300" style="display: none;"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function toggleConcepts(conceptsId) {
            const content = document.getElementById(conceptsId);
            const icon = document.getElementById(`icon-${conceptsId}`);
            
            if (content.classList.contains('collapsed')) {
                content.classList.remove('collapsed');
                content.style.maxHeight = content.scrollHeight + 'px';
                icon.textContent = 'â–²';
                icon.style.transform = 'rotate(180deg)';
            } else {
                content.classList.add('collapsed');
                content.style.maxHeight = '0';
                icon.textContent = 'â–¼';
                icon.style.transform = 'rotate(0deg)';
            }
        }

        function toggleCode(codeId) {
            const content = document.getElementById(codeId);
            const toggle = document.getElementById(`toggle-${codeId}`);
            
            if (content.classList.contains('collapsed')) {
                content.classList.remove('collapsed');
                content.style.maxHeight = '400px';
                toggle.textContent = 'ì ‘ê¸°';
            } else {
                content.classList.add('collapsed');
                content.style.maxHeight = '0';
                toggle.textContent = 'í¼ì¹˜ê¸°';
            }
        }

        // ì´ˆê¸° ìƒíƒœ ì„¤ì •
        document.addEventListener('DOMContentLoaded', function() {
            // ëª¨ë“  conceptsëŠ” ì²˜ìŒì— í¼ì³ì ¸ ìˆìŒ
            const conceptsContents = document.querySelectorAll('.concepts-content');
            conceptsContents.forEach(content => {
                content.style.maxHeight = content.scrollHeight + 'px';
            });
        });

        // Placeholder functions for shader compilation
        function compileShader(id) {
            console.log(`Compiling shader ${id}...`);
            // ì‹¤ì œ ì…°ì´ë” ì»´íŒŒì¼ ë¡œì§ì´ ì—¬ê¸°ì— ë“¤ì–´ê°‘ë‹ˆë‹¤
        }
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/canvaskit-wasm/0.38.0/canvaskit.min.js"></script>
    <script src="shader-tutorial.js"></script>
</body>
</html>