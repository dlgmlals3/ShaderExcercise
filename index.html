<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SKSL 셰이더 교육 자료</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="header">
        <h1> SKSL 셰이더 교육 자료</h1>
        <p>Chapter 0. 시작하면서 ...</p>

        <nav class="chapter-nav">
            <a href="index.html" class="chapter-btn active"> 0. 시작하면서</a>
            <a href="chapter1.html" class="chapter-btn">1. 기본 도형과 패턴
            <a href="chapter2.html" class="chapter-btn">2. 기본 도형 회전 이동 확대
            <a href="chapter3.html" class="chapter-btn">3. 랜덤 함수와 노이즈 함수 </a><br>
            <a href="chapter4.html" class="chapter-btn">4. Fractal </a>
            <a href="chapter5.html" class="chapter-btn">5. 이미지 필터링 및 컬러 커브 </a>
            <a href="chapter6.html" class="chapter-btn">6. 블러 알고리즘 </a>
        </nav>
    </div>

    <div class="container">
        <div class="lesson">
            <div class="lesson-header">
                <div class="lesson-title"> SKSL 기본 함수 익히기 </div>
                <div class="lesson-description">
                    <h3> 학습 목표</h3>                    
                    아래 사이트는 canvasKit을 사용하여 직접 만들었습니다. <br>
                    - https://skia.org/docs/user/modules/canvaskit/
                    기본 API Document 주소 입니다. 옆에 띄워주세요 <br>
                    - https://thebookofshaders.com/glossary/ <br><br>
                    
                    1) step, smoothstep, fract, mod, abs, square, sqrt, sin, cos, tan, exp 그래프를 손으로 그려볼 수 있다. <br>
                    float y 값에 원하는 아래 수식을 넣어보고 어떻게 그려지는지 확인하세용! <br><br>

                    2) 그래프 정규화 영역은 -1 ~ 1 입니다. <br>
                    좌표 정규화는 가장 기본적이고 중요한 내용입니다. <br>
                    아래 내용을 테스트 해보시고 xy -4 ~ 4 정규화 하고 원점을 중앙으로 맞추어 보세요. <br>
                    - 스키아 좌표계는 Y 좌표가 반대 입니다. <br>
                    - 이해를 돕기 위해 uv.y = 1.0 - uv.y; // Skia 좌표계 y축 반전 코드를 추가해 주세요<br><br>

                    4) Uv 값을 더하거나 빼는 경우, 시각적으로 반대로 보입니다.
                </div>
            </div>
            
            
            <div class="key-concepts">
                <div class="concepts-header" onclick="toggleConcepts('concepts5')">
                    <h4> 좌표계 정규화 방법 </h4><br>                    
                    <span class="toggle-icon" id="icon-concepts5">▼</span>
                </div>
                <div class="concepts-content" id="concepts5">
                    <ul>                        
                        <h3>꼭 알아 두자.</h3>
                        <div class="code-example">                     
<code>0 ~ 1 좌표계 정규화 --> uv = fragCoord / iResolution.xy; 
종횡비 보정 --> uv.y *= iResolution.y / iResolution.x;
Skia y축 반전 --> uv.y = 1.0 - uv.y; // Skia 좌표계 y축 반전
원점으로 좌표계 정규화 --> uv -= .5;</code>
                        </div>

                        <li><strong> 0 - 1 정규화 </strong><br>
                            <div class="code-example">                     
<code>uv = fragCoord / iResolution;
//uv.y = 1.0 - uv.y; // Skia 좌표계 y축 반전
float y = p.x;
//if (uv.x > .5) y = 0.;
</code>
                            </div>
                        </li>
                        <li><strong> -.5 ~ .5 정규화 </strong><br>
                            <div class="code-example">
<code>uv = fragCoord / iResolution;
uv.y = 1.0 - uv.y; // Skia 좌표계  y축 반전
uv -= .5;
float y = p.x;
//if (uv.x > .3 || uv.x < -.3) y = 0.;
</code>
                            </div>
                        </li>
                        <li><strong> 실습 -1 ~ 1 만들어보자. </strong><br>
                            <div class="code-example">
<code>uv = fragCoord / iResolution;
uv.y *= iResolution.y / iResolution.x;
//uv.y = 1.0 - uv.y; // Skia 좌표계 y축 반전
float y = p.x;
//if (uv.x > 0.9 || uv.x < -0.9) y = 0.;
</code>
                            </div>
                        </li>                        
                    </ul>
                </div>
            </div>

            <div class="key-concepts">
                <div class="concepts-header" onclick="toggleConcepts('concepts1')">
                    <h4> 자주 사용하는 함수 및 그래프 ( 라이브러리 포함 )</h4>
                    <span class="toggle-icon" id="icon-concepts1">▼</span>
                </div>
                <div class="concepts-content" id="concepts1">
                    <h3> <br> 라이프러리 포함된 Editor의 좌표계 : -1 ~ 1</h3><br>
                    
                    <ul>
                        <li><strong>1. 직선:</strong><br>
                            <div class="code-example">
                                <code>float y = p.x;</code>
                            </div>
                        </li>

                        <li><strong>2. Clamp 곡선 : </strong><br>
                            <div class="code-example">
                                <code>float y = clamp(p.x, 0, 1);</code>
                            </div>
                        </li>
                        
                        <li><strong>3. Step (계단 그래프):</strong><br>
                            <div class="code-content" id="step-code">
                                <div class="code-example">
                                    <code>float y = step(0.5, p.x);
//if (p.x < -0.3 && p.x > -0.5) y = .3;
//if (p.x > 0.3 && p.x < 0.5) y = .6;
</code>
                                </div>
                            </div>
                        </li>
                        
                        <li><strong>4. SmoothStep:</strong><br>
                            <div class="code-example">
                                <code>float y = smoothstep(0.0, 1.0, p.x);<br>p.x = clamp(p.x, 0, 1);<br>//float y = p.x * p.x * (3.0 - 2.0 * p.x);</code>
                            </div>
                        </li>

                        <li><strong>5. Fract 곡선 (톱니파 모양):</strong><br>
                            <div class="code-example">
                                <code>float y = fract(sin(p.x));</code>
                            </div>
                            <em>fract(-1.3) = -2.0 + 0.7<br>fract(1.3) = 1.0 + 0.3</em>
                        </li>

            
                        <li><strong>6. Floor : (내림)</strong><br>
                            <div class="code-example">
                                <code>//p *= 3.0;<br>float y = floor(p.x);</code>
                            </div>
                        </li>

                        <li><strong>7. Dot :</strong><br>
                            <div class="code-example">
                                <code>p *= 3.0;<br>float y = dot(p.x, p.x);</code><br>
                                // 스칼라로 만들어줌.
                            </div>
                        </li>
                        

                        <li><strong>8. mod:</strong><br>
                            <div class="code-example">
                                <code>float y = mod(p.x, 0.5);</code>
                            </div>
                        </li>

                        <li><strong>9. 절대값 곡선 (대칭):</strong><br>
                            <div class="code-example">
                                <code>float y = abs(p.x);</code>
                            </div>
                        </li>
                        
                        <li><strong>10. 제곱 곡선:</strong><br>
                            <div class="code-example">
                                <code>float y = p.x * p.x;</code>
                            </div>
                        </li>
                        
                        <li><strong>11. 제곱근:</strong><br>
                            <div class="code-example">
                                <code>float y = sqrt(p.x);</code>
                            </div>
                        </li>

                        <li><strong>12. 사인 곡선:</strong><br>
                            <div class="code-example">
                                <code>p.x *= 3.14;<br>float y = sin(p.x);</code>
                            </div>
                        </li>

                        <li><strong>13. 코사인:</strong><br>
                            <div class="code-example">
                                <code>p.x *= 3.14;<br>float y = cos(p.x);</code>
                            </div>
                        </li>
                        
                        <li><strong>14. 탄젠트:</strong><br>
                            <div class="code-example">
                                <code>p.x *= 3.14;<br>float y = tan(p.x);</code>
                            </div>
                        </li>
                        
                        <li><strong>15. 가우시안 곡선:</strong><br>
                            <div class="code-example">
                                <code>float y = exp(-p.x * p.x);</code>
                            </div>
                        </li>
                        
                        <li><strong>16. Triangular Wave (지그재그):</strong><br>
                            <div class="code-example">
                                <code>float y = abs(fract(p.x) * 2.0 - 1.0);</code>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="lesson-content">
                <div class="editor-section">
                    <div class="section-header">SKSL 실습 코드</div>
                    <textarea class="code-editor" id="editor1">
float y = p.x;           
                    </textarea>
                    <div class="controls">
                        <button class="btn" onclick="compileShader(1)"> 실행</button>                     
                    </div>
                </div>
                
                <div class="preview-section">
                    <div class="section-header">미리보기</div>
                    <div id="error1"></div>
                    <div class="preview-container">
                        <div class="loading" id="loading1">CanvasKit 로딩 중...</div>
                        <canvas class="preview-canvas" id="canvas1" width="300" height="300" style="display: none;"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function toggleConcepts(conceptsId) {
            const content = document.getElementById(conceptsId);
            const icon = document.getElementById(`icon-${conceptsId}`);
            
            if (content.classList.contains('collapsed')) {
                content.classList.remove('collapsed');
                content.style.maxHeight = content.scrollHeight + 'px';
                icon.textContent = '▲';
                icon.style.transform = 'rotate(180deg)';
            } else {
                content.classList.add('collapsed');
                content.style.maxHeight = '0';
                icon.textContent = '▼';
                icon.style.transform = 'rotate(0deg)';
            }
        }

        function toggleCode(codeId) {
            const content = document.getElementById(codeId);
            const toggle = document.getElementById(`toggle-${codeId}`);
            
            if (content.classList.contains('collapsed')) {
                content.classList.remove('collapsed');
                content.style.maxHeight = '400px';
                toggle.textContent = '접기';
            } else {
                content.classList.add('collapsed');
                content.style.maxHeight = '0';
                toggle.textContent = '펼치기';
            }
        }

        // 초기 상태 설정
        // 초기 상태 설정
        document.addEventListener('DOMContentLoaded', function() {
            // concepts2, concepts3만 닫고 싶다면:
            const sectionsToClose = ['concepts1', 'concepts2', 'concepts3', 'concepts4', 'concepts5', 'concepts6', 'concepts7',
                'concepts8'
            ];
            
            sectionsToClose.forEach(conceptsId => {
                const content = document.getElementById(conceptsId);
                const icon = document.getElementById(`icon-${conceptsId}`);
                const header = document.querySelector(`[onclick="toggleConcepts('${conceptsId}')"]`);
                
                if (content) {
                    content.classList.add('collapsed');
                    content.style.maxHeight = '0';
                }
                if (icon) {
                    icon.textContent = '▼';
                }
                if (header) {
                    header.classList.add('closed');
                }
            });
        });

        // Placeholder functions for shader compilation
        function compileShader(id) {
            console.log(`Compiling shader ${id}...`);
            // 실제 셰이더 컴파일 로직이 여기에 들어갑니다
        }
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/canvaskit-wasm/0.38.0/canvaskit.min.js"></script>
    <script src="shader-tutorial.js"></script>
</body>
</html>